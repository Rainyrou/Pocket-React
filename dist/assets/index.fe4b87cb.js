import{_ as ne,a as oe,b as se,r as f,c as H,d as M,e as ce,R as r,l as W,f as ee,u as Ne,C as ie,I as L,P as le}from"./index.643a4602.js";import{A as B}from"./index.a6c30508.js";import{d as ue,P as Pe}from"./index.6a8f6d46.js";import{C as Te}from"./index.9ad9f9a9.js";import{E as w,g as Ye,t as $e,P as Oe,R as k,L as I,a as Re}from"./index.a7e9ada9.js";import{c as X}from"./index.b4ed5761.js";import{P as ke}from"./index.1cbaceb4.js";import{C as je}from"./ConfigReceiver.47be707e.js";import"./_baseGet.65c9cd2f.js";import"./index.f209f82c.js";var te=globalThis,Be=function(d,c){var t,e=Date.now();return function(){for(var o=arguments.length,s=new Array(o),n=0;n<o;n++)s[n]=arguments[n];var i=Date.now(),u=c-(i-e);clearTimeout(t),u<=0?(d.apply(te,s),e=i):t=window.setTimeout(function(){d.apply(te,s),e=Date.now()},u)}},Me=Be;function re(a,d){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(a);d&&(t=t.filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable})),c.push.apply(c,t)}return c}function z(a){for(var d=1;d<arguments.length;d++){var c=arguments[d]!=null?arguments[d]:{};d%2?re(Object(c),!0).forEach(function(t){H(a,t,c[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(c)):re(Object(c)).forEach(function(t){Object.defineProperty(a,t,Object.getOwnPropertyDescriptor(c,t))})}return a}function We(a){var d=Ie();return function(){var t=M(a),e;if(d){var o=M(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return ce(this,e)}}function Ie(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function F(a){return a&&!("touches"in a)}var pe=function(a){ne(c,a);var d=We(c);function c(){var t;oe(this,c);for(var e=arguments.length,o=new Array(e),s=0;s<e;s++)o[s]=arguments[s];return t=d.call.apply(d,[this].concat(o)),t.currentX=void 0,t.currentY=void 0,t.dragState=Object.create(null),t.onTouchStart=function(n){if(t.dragState.startTime=new Date,F(n))t.dragState.startX=n.clientX,t.dragState.startY=n.clientY,w.on(document.body,"mousemove",t.onTouchMove),w.on(document.body,"mouseup",t.onTouchEnd);else{var i=n.touches[0];t.dragState.startX=i.pageX,t.dragState.startY=i.pageY}var u=z({},t.dragState),l=t.props.onDragStart;typeof l=="function"&&l(n,u)},t.onTouchMove=function(n){if(!t.isDragStart)return!1;if(F(n))t.currentX=n.clientX,t.currentY=n.clientY;else{var i=n.touches[0];t.currentX=i.pageX,t.currentY=i.pageY}var u=t.currentX-t.dragState.startX,l=t.currentY-t.dragState.startY,p=z(z({},t.dragState),{},{offsetX:u,offsetY:l}),m=t.props.onDragMove;typeof m=="function"&&!m(n,p)||(t.dragState=p)},t.onTouchEnd=function(n){if(!t.isDragStart)return!1;F(n)&&(w.off(document.body,"mousemove",t.onTouchMove),w.off(document.body,"mouseup",t.onTouchEnd));var i=t.props.onDragEnd;typeof i=="function"&&i(n,t.dragState),t.dragState=Object.create(null)},t}return se(c,[{key:"isDragStart",get:function(){return this.dragState.startX!==void 0&&this.dragState.startY!==void 0}},{key:"render",value:function(){var e=this.props.children;return f.exports.cloneElement(e,{onTouchStart:this.onTouchStart,onTouchMove:this.onTouchMove,onTouchEnd:this.onTouchEnd,onMouseDown:this.onTouchStart,onMouseMove:this.onTouchMove,onMouseUp:this.onTouchEnd})}}]),c}(f.exports.PureComponent),h;(function(a){a[a.normal=0]="normal",a[a.pull=1]="pull",a[a.drop=2]="drop",a[a.loading=3]="loading",a[a.success=4]="success",a[a.failure=5]="failure"})(h||(h={}));var E;(function(a){a[a.normal=0]="normal",a[a.abort=1]="abort",a[a.loading=2]="loading",a[a.success=3]="success",a[a.failure=4]="failure",a[a.complete=5]="complete"})(E||(E={}));function ae(a,d){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(a);d&&(t=t.filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable})),c.push.apply(c,t)}return c}function C(a){for(var d=1;d<arguments.length;d++){var c=arguments[d]!=null?arguments[d]:{};d%2?ae(Object(c),!0).forEach(function(t){H(a,t,c[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(c)):ae(Object(c)).forEach(function(t){Object.defineProperty(a,t,Object.getOwnPropertyDescriptor(c,t))})}return a}function Xe(a){var d=ze();return function(){var t=M(a),e;if(d){var o=M(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return ce(this,e)}}function ze(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var de=function(a){ne(c,a);var d=Xe(c);function c(t){var e;return oe(this,c),e=d.call(this,t),e.pull=void 0,e.wrap=void 0,e.throttledScroll=void 0,e.wrapTouchstartY=void 0,e.mounted=!0,e.getScrollContainer=function(){return console.warn("Warning: getScrollContainer() has been renamed, and is not recommended for use.\n\n* Rename `getScrollContainer()` to `scrollContainer` to suppress this warning."),e.scrollContainer},e.wrapTouchstart=function(o){var s=o.touches[0];e.wrapTouchstartY=s.pageY},e.wrapTouchmove=function(o){var s=o.touches[0],n=s.pageY;n-e.wrapTouchstartY>0&&o.cancelable&&e.scrollTop===0&&o.preventDefault()},e.wrapTouchEnd=function(){e.wrapTouchstartY=0,e.setState({animationDuration:e.props.animationDuration})},e.addEvent=function(){e.wrap!==e.scrollContainer&&(e.wrap&&e.removeEvent(),e.wrap=e.scrollContainer,w.on(e.wrap,"scroll",e.throttledScroll),w.on(e.wrap,"touchstart",e.wrapTouchstart),w.on(e.wrap,"touchmove",e.wrapTouchmove),w.on(e.wrap,"touchend",e.wrapTouchEnd))},e.removeEvent=function(){w.off(e.wrap,"scroll",e.throttledScroll),w.off(e.wrap,"touchstart",e.wrapTouchstart),w.off(e.wrap,"touchmove",e.wrapTouchmove),w.off(e.wrap,"touchend",e.wrapTouchEnd)},e.onScroll=function(){var o=e.state,s=o.refreshState,n=o.loadState,i=e.wrap,u=i.scrollHeight,l=u===void 0?document.body.clientHeight:u,p=i.clientHeight,m=p===void 0?document.documentElement.clientHeight:p,v=C(C({},c.defaultProps.load),e.props.load),S=v.handler,_=v.distance;typeof S!="function"||s!==h.normal||n!==E.normal||l<=m||l-e.scrollTop-_>m||S()},e.onDragMove=function(o,s){var n=s.offsetY,i=e.props.refresh,u=i.handler;if(!u||n<=0||n>0&&e.scrollTop>0||e.state.refreshState>=h.loading)return!1;w.supportsPassiveEvents||o.preventDefault();var l=C(C({},c.defaultProps.refresh),e.props.refresh),p=l.startDistance,m=l.distance,v=n/3,S=v-p<m?h.pull:h.drop;return e.doRefreshAction(S,v),!0},e.onDragEnd=function(o,s){var n=s.offsetY;if(!!n){var i=e.state.refreshState;if(i===h.pull){e.doRefreshAction(h.normal);return}var u=e.props.refresh,l=u.handler;typeof l=="function"&&l()}},e.doTransition=function(o){var s=o.offsetY,n=o.animationDuration;e.setState({offsetY:s,animationDuration:n})},e.doRefreshAction=function(o,s){var n=e.props,i=n.animationDuration,u=n.stayTime;switch(e.setState({refreshState:o}),o){case h.pull:case h.drop:e.doTransition({offsetY:s,animationDuration:0});break;case h.loading:e.doTransition({offsetY:"auto",animationDuration:i});break;case h.success:case h.failure:e.doTransition({offsetY:"auto",animationDuration:i}),setTimeout(function(){!e.mounted||(e.doRefreshAction(h.normal),e.doLoadAction(E.normal))},u);break;default:e.doTransition({offsetY:0,animationDuration:i})}},e.doLoadAction=function(o){var s=e.props.stayTime;switch(e.setState({loadState:o}),o){case E.success:e.doLoadAction(E.normal);break;case E.failure:setTimeout(function(){!e.mounted||e.doLoadAction(E.abort)},s);break}},e.renderRefresh=function(){var o=C(C({},c.defaultProps.refresh),e.props.refresh),s=o.startDistance,n=o.distance,i=o.render,u=e.state,l=u.refreshState,p=u.offsetY,m=0;if(p>=s&&(m=(p-s<n?p-s:n)*100/n),typeof i=="function")return i(l,m);var v=e.props,S=v.prefixCls,_=v.locale,b="".concat(S,"__control");switch(l){case h.pull:return r.createElement("div",{className:b},r.createElement(B,{loading:!1,percent:m}),r.createElement("span",null,_.pullText));case h.drop:return r.createElement("div",{className:b},r.createElement(B,{loading:!1,percent:100}),r.createElement("span",null,_.dropText));case h.loading:return r.createElement("div",{className:b},r.createElement(B,{type:"spinner"}),r.createElement("span",null,_.loadingText));case h.success:return r.createElement("div",{className:b},r.createElement(W.SuccessCircle,{theme:"success"}),r.createElement("span",null,_.successText));case h.failure:return r.createElement("div",{className:b},r.createElement(W.WarningCircle,{theme:"danger"}),r.createElement("span",null,_.failureText))}},e.renderLoad=function(){var o=C(C({},c.defaultProps.load),e.props.load),s=o.render,n=e.state.loadState;if(typeof s=="function")return s(n);var i=e.props,u=i.prefixCls,l=i.locale,p="".concat(u,"__control");switch(n){case E.loading:return r.createElement("div",{className:p},r.createElement(B,{type:"spinner"}),r.createElement("span",null,l.loadingText));case E.failure:return r.createElement("div",{className:p},r.createElement(W.WarningCircle,{theme:"danger"}),r.createElement("span",null,l.failureText));case E.complete:return r.createElement("div",{className:p},r.createElement("span",null,l.completeText))}},e.state={offsetY:0,animationDuration:0,refreshState:t.refresh.state,loadState:t.load.state},e.throttledScroll=Me(e.onScroll,250),e}return se(c,[{key:"componentDidMount",value:function(){this.mounted=!0,this.addEvent()}},{key:"componentDidUpdate",value:function(e){this.addEvent();var o=this.props,s=o.load,n=o.refresh;e.load.state!==s.state&&this.doLoadAction(s.state),e.refresh.state!==n.state&&this.doRefreshAction(n.state)}},{key:"componentWillUnmount",value:function(){this.mounted=!1,this.removeEvent()}},{key:"scrollContainer",get:function(){var e=function(o){for(;o&&o.parentNode&&o.parentNode!==document.body;){var s=window.getComputedStyle(o);if((["scroll","auto"].indexOf(s.overflowY)>-1||["scroll","auto"].indexOf(s.overflow)>-1)&&(parseInt(s.height,10)>0||parseInt(s.maxHeight,10)>0))return o;o=o.parentNode}}(this.pull)||window;return e}},{key:"scrollTop",get:function(){return Ye(this.wrap)}},{key:"render",value:function(){var e=this,o=this.props,s=o.prefixCls,n=o.className,i=o.style,u=o.children,l=this.state,p=l.offsetY,m=l.animationDuration,v=l.refreshState,S=l.loadState,_=ee(s,n),b=ee("".concat(s,"__load"),H({},"".concat(s,"__load--show"),S>=E.loading)),D={WebkitTransition:"all ".concat(m,"ms"),transition:"all ".concat(m,"ms")};return v<=h.drop&&(D.WebkitTransform="translate3d(0, ".concat(p,"px, 0)"),D.transform="translate3d(0, ".concat(p,"px, 0)")),r.createElement(pe,{onDragMove:this.onDragMove,onDragEnd:this.onDragEnd},r.createElement("div",{className:_,style:i},r.createElement("div",{className:"".concat(s,"__content"),style:D,ref:function($){e.pull=$}},r.createElement("div",{className:"".concat(s,"__refresh")},this.renderRefresh()),r.createElement("div",{className:"".concat(s,"__body")},u),r.createElement("div",{className:b},this.renderLoad()))))}}],[{key:"getDerivedStateFromProps",value:function(e,o){var s=e.load,n=e.refresh,i=o.prevLoad,u=i===void 0?{}:i,l=o.prevRefresh,p=l===void 0?{}:l;return"load"in e&&s.state!==u.state?{loadState:s.state,prevLoad:s}:"refresh"in e&&n.state!==p.state?{refreshState:n.state,prevRefresh:n}:null}}]),c}(f.exports.PureComponent);de.defaultProps={prefixCls:"za-pull",refresh:{state:h.normal,startDistance:30,distance:30},load:{state:E.normal,distance:0},animationDuration:400,stayTime:1e3};var Fe=je("Pull")(de);const Le="_item_12dzf_1",He="_header-date_12dzf_7",Ue="_date_12dzf_18",Ke="_money_12dzf_22",qe="_item-icon_12dzf_45";var P={item:Le,headerDate:He,date:Ue,money:Ke,itemIcon:qe};const Ae=({bill:a})=>{const[d,c]=f.exports.useState(0),[t,e]=f.exports.useState(0),o=Ne();f.exports.useEffect(()=>{const n=a.bills.filter(u=>u.pay_type===2).reduce((u,l)=>(u+=Number(l.amount),u),0);c(n);const i=a.bills.filter(u=>u.pay_type===1).reduce((u,l)=>(u+=Number(l.amount),u),0);e(i)},[a.bills]);const s=n=>{o.push(`/detail?id=${n.id}`)};return r.createElement("div",{className:P.item},r.createElement("div",{className:P.headerDate},r.createElement("div",{className:P.date},a.date),r.createElement("div",{className:P.money},r.createElement("span",null,r.createElement("img",{src:"//s.yezgea02.com/1615953405599/zhi%402x.png",alt:"\u652F"}),r.createElement("span",null,"\xA5",t.toFixed(2))),r.createElement("span",null,r.createElement("img",{src:"//s.yezgea02.com/1615953405599/shou%402x.png",alt:"\u6536"}),r.createElement("span",null,"\xA5",d.toFixed(2))))),a&&a.bills.sort((n,i)=>i.date-n.date).map(n=>r.createElement(Te,{className:P.bill,key:n.id,onClick:()=>s(n),title:r.createElement(r.Fragment,null,r.createElement(ie,{className:P.itemIcon,type:n.type_id?$e[n.type_id].icon:1}),r.createElement("span",null,n.type_name)),description:r.createElement("span",{style:{color:n.pay_type==2?"red":"#39be77"}},`${n.pay_type==1?"-":"+"}${n.amount}`),help:r.createElement("div",null,ue(Number(n.date)).format("HH:mm")," ",n.remark?`| ${n.remark}`:"")})))},Ge="_home_4rs37_1",Je="_header_4rs37_7",Qe="_data-wrap_4rs37_22",Ve="_income_4rs37_33",Ze="_type-wrap_4rs37_36",et="_left_4rs37_48",tt="_arrow_4rs37_51",rt="_content-wrap_4rs37_55",at="_add_4rs37_65";var y={home:Ge,header:Je,dataWrap:Qe,income:Ve,typeWrap:Ze,left:et,arrow:tt,contentWrap:rt,add:at};const nt="_popup-type_4v4ui_1",ot="_header_4v4ui_7",st="_cross_4v4ui_20",ct="_content_4v4ui_28",it="_all_4v4ui_31",lt="_title_4v4ui_38",ut="_expense-wrap_4v4ui_43",pt="_income-wrap_4v4ui_44",dt="_active_4v4ui_58";var x={popupType:nt,header:ot,cross:st,content:ct,all:it,title:lt,expenseWrap:ut,incomeWrap:pt,active:dt};const U=f.exports.forwardRef(({onSelect:a},d)=>{U.displayName="PopupType";const[c,t]=f.exports.useState(!1),[e,o]=f.exports.useState("all"),[s,n]=f.exports.useState([]),[i,u]=f.exports.useState([]);f.exports.useEffect(async()=>{const p=[{id:1,name:"\u9910\u996E",type:"1",user_id:0},{id:2,name:"\u670D\u9970",type:"1",user_id:0},{id:3,name:"\u4EA4\u901A",type:"1",user_id:0},{id:4,name:"\u65E5\u7528",type:"1",user_id:0},{id:5,name:"\u8D2D\u7269",type:"1",user_id:0},{id:6,name:"\u5B66\u4E60",type:"1",user_id:0},{id:7,name:"\u533B\u7597",type:"1",user_id:0},{id:8,name:"\u65C5\u884C",type:"1",user_id:0},{id:9,name:"\u4EBA\u60C5",type:"1",user_id:0},{id:10,name:"\u5176\u4ED6",type:"1",user_id:0},{id:11,name:"\u5DE5\u8D44",type:"2",user_id:0},{id:12,name:"\u5956\u91D1",type:"2",user_id:0},{id:13,name:"\u8F6C\u8D26",type:"2",user_id:0},{id:14,name:"\u7406\u8D22",type:"2",user_id:0},{id:15,name:"\u9000\u6B3E",type:"2",user_id:0},{id:16,name:"\u5176\u4ED6",type:"2",user_id:0}];n(p.filter(m=>m.type==="1")),u(p.filter(m=>m.type==="2"))},[]),d&&(d.current={show:()=>{t(!0)},close:()=>{t(!1)}});const l=p=>{o(p.id),t(!1),a(p)};return r.createElement(Oe,{visible:c,direction:"bottom",onMaskClick:()=>t(!1),destroy:!1,mountContainer:()=>document.body},r.createElement("div",{className:x.popupType},r.createElement("div",{className:x.header},"\u8BF7\u9009\u62E9\u7C7B\u578B",r.createElement(L,{type:"wrong",className:x.cross,onClick:()=>t(!1)})),r.createElement("div",{className:x.content},r.createElement("div",{onClick:()=>l({id:"all"}),className:X({[x.all]:!0,[x.active]:e==="all"})},"\u5168\u90E8\u7C7B\u578B"),r.createElement("div",{className:x.title},"\u652F\u51FA"),r.createElement("div",{className:x.expenseWrap},s.map((p,m)=>r.createElement("p",{key:m,onClick:()=>l(p),className:X({[x.active]:e===p.id})},p.name))),r.createElement("div",{className:x.title},"\u6536\u5165"),r.createElement("div",{className:x.incomeWrap},i.map((p,m)=>r.createElement("p",{key:m,onClick:()=>l(p),className:X({[x.active]:e===p.id})},p.name))))))});U.propTypes={onSelect:le.func};const ft="_empty_1wb2f_1";var mt={empty:ft};const fe=({desc:a})=>r.createElement("div",{className:mt.empty},r.createElement("img",{src:"//s.yezgea02.com/1619144597039/empty.png",alt:"\u6682\u65E0\u6570\u636E"}),r.createElement("div",null,a||"\u6682\u65E0\u6570\u636E"));fe.propTypes={desc:le.string};let T=[300,400];const bt=()=>{const a=f.exports.useRef(),d=f.exports.useRef(),[c,t]=f.exports.useState([300,400]),[e,o]=f.exports.useState(!1);f.exports.useEffect(()=>(d.current.getBoundingClientRect(),a.current.getBoundingClientRect(),T[0]=300,T[1]=400,t(T),document.body.style.overflow="hidden",()=>{document.body.style.overflow="auto"}),[]);const s=(g,N)=>{o(!0)},n=(g,N)=>{const{width:J,height:Q}=d.current.getBoundingClientRect(),{width:V,height:Z}=a.current.getBoundingClientRect();let O=T[0]+N.offsetX,R=T[1]+N.offsetY;return O<0&&(O=0),O>V-J&&(O=V-J),R<0&&(R=0),R>Z-Q&&(R=Z-Q),t([O,R]),!0},i=(g,N)=>{T=c,o(!1)},u=()=>{l.current&&l.current.show()},l=f.exports.useRef(),p=f.exports.useRef(),m=f.exports.useRef(),[v,S]=f.exports.useState({}),[_,b]=f.exports.useState(ue().format("YYYY-MM")),[D,Y]=f.exports.useState(1),[$,K]=f.exports.useState([]),[me,he]=f.exports.useState(0),[ve,j]=f.exports.useState(k.normal),[ge,q]=f.exports.useState(I.normal),[ye,_e]=f.exports.useState(0),[Ee,we]=f.exports.useState(0);f.exports.useEffect(()=>{A()},[D,v,_]);const A=async()=>{const{data:g}=await Re(`/api/bill/list?page=${D}&page_size=5&date=${_}&type_id=${v.id||"all"}`);K(D===1?g.list:$.concat(g.list)),_e(g.totalExpense.toFixed(2)),we(g.totalIncome.toFixed(2)),he(g.totalPage),q(I.success),j(k.success)},xe=()=>{p.current&&p.current.show()},Se=g=>{j(k.loading),Y(1),S(g)},G=()=>{j(k.loading),D!=1?Y(1):A()},De=()=>{D<me&&(q(I.loading),Y(D+1))},be=()=>{m.current&&m.current.show()},Ce=g=>{j(k.loading),Y(1),b(g)};return r.createElement("div",{className:y.home,style:{position:"relative"},ref:a},r.createElement("div",{className:y.header},r.createElement("div",{className:y.dataWrap},r.createElement("span",{className:y.expense},"\u603B\u652F\u51FA\uFF1A",r.createElement("b",null,"\xA5 ",ye)),r.createElement("span",{className:y.income},"\u603B\u6536\u5165\uFF1A",r.createElement("b",null,"\xA5 ",Ee))),r.createElement("div",{className:y.typeWrap},r.createElement("div",{className:y.left,onClick:xe},r.createElement("span",{className:y.title},v.name||"\u5168\u90E8\u7C7B\u578B"," ",r.createElement(L,{className:y.arrow,type:"arrow-bottom"}))),r.createElement("div",{className:y.right},r.createElement("span",{className:y.time,onClick:be},_,r.createElement(L,{className:y.arrow,type:"arrow-bottom"}))))),r.createElement("div",{className:y.contentWrap},$.length?r.createElement(Fe,{animationDuration:200,stayTime:400,refresh:{state:ve,handler:G},load:{state:ge,distance:200,handler:De}},$.map((g,N)=>r.createElement(Ae,{bill:g,key:N}))):r.createElement(fe,null)),r.createElement(pe,{onDragStart:s,onDragMove:n,onDragEnd:i},r.createElement("div",{ref:d,style:{display:"inline-block",position:"fixed",transform:`translate3d(${c[0]}px, ${c[1]}px, 0)`}},r.createElement("div",{className:y.add,onClick:u},r.createElement(ie,{type:"tianjia"})))),r.createElement(U,{ref:p,onSelect:Se}),r.createElement(Pe,{ref:m,mode:"month",onSelect:Ce}),r.createElement(ke,{ref:l,onReload:G}))};export{bt as default};
