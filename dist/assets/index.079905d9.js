import{R as e,q as z,r,C as l}from"./index.643a4602.js";import{C as p}from"./index.9ad9f9a9.js";import{I as i}from"./index.f209f82c.js";import{T as o,s as _}from"./index.a7e9ada9.js";import"./index.a6c30508.js";import{B as w}from"./index.d7aa8145.js";import{c as C}from"./index.b4ed5761.js";import"./ConfigReceiver.47be707e.js";const N="_auth_pvcr1_1",y="_gradientBG_pvcr1_1",b="_head_pvcr1_7",x="_tab_pvcr1_14",I="_active_pvcr1_33",k="_form_pvcr1_39",S="_za-cell_pvcr1_42",G="_za-input-wrapper_pvcr1_50",R="_za-input_pvcr1_50",A="_operation_pvcr1_56",T="_custom-gradient-button_pvcr1_59";var t={auth:N,gradientBG:y,head:b,tab:x,active:I,form:k,zaCell:S,zaInputWrapper:G,zaInput:R,operation:A,customGradientButton:T};const D=e.lazy(()=>z(()=>import("./index.720808c2.js"),["assets/index.720808c2.js","assets/index.643a4602.js","assets/index.2831367d.css","assets/index.b4ed5761.js"])),H=()=>{const h=r.exports.useRef(),[s,n]=r.exports.useState("login"),[d,v]=r.exports.useState(""),[c,E]=r.exports.useState(""),[u,g]=r.exports.useState(""),[m,f]=r.exports.useState(""),B=r.exports.useCallback(a=>{v(a)},[]),F=async()=>{if(!c){o.show("\u8BF7\u8F93\u5165\u8D26\u53F7");return}if(!u){o.show("\u8BF7\u8F93\u5165\u5BC6\u7801");return}try{if(s=="login"){const{data:a}=await _("/api/user/login",{username:c,password:u});localStorage.setItem("token",a.token),o.show("\u767B\u5F55\u6210\u529F"),window.location.href="/"}else{if(!m){o.show("\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801");return}if(m!=d){o.show("\u9A8C\u8BC1\u7801\u9519\u8BEF");return}const{data:a}=await _("/api/user/register",{username:c,password:u});o.show("\u6CE8\u518C\u6210\u529F"),n("login")}}catch(a){o.show(a.msg)}};return r.exports.useEffect(()=>{document.title=s=="login"?"\u767B\u5F55":"\u6CE8\u518C"},[s]),e.createElement("div",{className:t.auth},e.createElement("div",{className:t.head}),e.createElement("div",{className:t.tab},e.createElement("span",{className:C({[t.avtive]:s=="login"}),onClick:()=>n("login")},"\u767B\u5F55"),e.createElement("span",{className:C({[t.avtive]:s=="register"}),onClick:()=>n("register")},"\u6CE8\u518C")),e.createElement("div",{className:t.form},e.createElement(p,{className:t.zaCell,icon:e.createElement(l,{type:"zhanghao"})},e.createElement(i,{className:t.zaInput,clearable:!0,type:"text",placeholder:"\u8BF7\u8F93\u5165\u8D26\u53F7",onChange:a=>E(a)})),e.createElement(p,{className:t.zaCell,icon:e.createElement(l,{type:"mima"})},e.createElement(i,{className:t.zaInput,clearable:!0,type:"password",placeholder:"\u8BF7\u8F93\u5165\u5BC6\u7801",onChange:a=>g(a)})),s=="register"?e.createElement(p,{className:t.zaCell,icon:e.createElement(l,{type:"mima"})},e.createElement(i,{className:t.zaInput,clearable:!0,type:"text",placeholder:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801",onChange:a=>f(a)}),e.createElement(r.exports.Suspense,{fallback:e.createElement("div",null,"Loading...")},e.createElement(D,{ref:h,charNum:4,onChange:B}))):null),e.createElement("div",{className:t.operation},e.createElement(w,{className:t.customGradientButton,onClick:F,block:!0,theme:"primary",shape:"round"},s=="login"?"\u767B\u5F55":"\u6CE8\u518C")))};export{H as default};
